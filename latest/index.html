<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RevEng_PAJ7620: Gesture Sensor - PAJ7620 / PAJ7620U2 / PAJ7620F2</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RevEng_PAJ7620
   &#160;<span id="projectnumber">1.4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Gesture Sensor - PAJ7620 / PAJ7620U2 / PAJ7620F2 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__github_workspace_README"></a> </p>
<h1><a class="anchor" id="autotoc_md1"></a>
Description</h1>
<p>The library here is for the PAJ7620 sensor with an I2C interface. The device also has several variants such as the PAJ7620U2 and PAJ7620F2. The device provides simple motion-based gesture recognition, object tracking (cursor mode), and other (unimplemented so far) modes.</p>
<p>In gesture mode it can recognize 9 hand moving gestures including:</p><ul>
<li>move up</li>
<li>move down</li>
<li>move left</li>
<li>move right</li>
<li>circle clockwise</li>
<li>circle anti-clockwise (counter-clockwise / widdershins)</li>
<li>forwards / towards</li>
<li>backards / away</li>
<li>wave</li>
</ul>
<p>The device also counts the quantity of hand waves, which is now available via an API call in version 1.2.</p>
<p>The sensor's datasheet is available <a href="https://datasheetspdf.com/pdf-file/1309990/PixArt/PAJ7620U2/1">here</a>.</p>
<p>The PAJ7620U2 is available from various vendors such as Seeed Studio on a breakout board. For more information about their product, please visit the <a href="http://wiki.seeedstudio.com/Grove-Gesture_v1.0/">wiki</a>. Breakout boards are also sold under the part number GY-PAJ7620 by various unnamed manufacturers.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md3"></a>
Installation</h1>
<p><b>Via ArduinoIDE/CLI</b></p>
<p>This library is available in the Arduino extended library collection. To install:</p><ul>
<li>Open ArduinoIDE</li>
<li>Select Tools-&gt;Manage Libraries...</li>
<li>In the search bar input: RevEng PAJ7620</li>
<li>Hover over the result and click "install"</li>
</ul>
<p><b>Selecting a release from GitHub</b></p>
<p>On the GitHub page (<a href="https://github.com/acrandal/RevEng_PAJ7620">https://github.com/acrandal/RevEng_PAJ7620</a>), there is a "releases" section in the right sidebar. You can click on the release version you would like to use, or just "Releases" for the latest one. On that page you'll find a "source code" link in various archive formats like tar.gz or zip. Download that and follow the directions in the next section here.</p>
<p><b>Manual install from the Git repository</b></p>
<p>To download from the repo, choose the branch you want, click the DOWNLOAD ZIP button, rename the uncompressed folder to <a class="el" href="classRevEng__PAJ7620.html" title="PAJ7620 Device API class - As developed by RevEng Devs.">RevEng_PAJ7620</a>. Check that the <a class="el" href="classRevEng__PAJ7620.html" title="PAJ7620 Device API class - As developed by RevEng Devs.">RevEng_PAJ7620</a> folder contains a src directory with <a class="el" href="RevEng__PAJ7620_8cpp.html">RevEng_PAJ7620.cpp</a> and <a class="el" href="RevEng__PAJ7620_8h.html">RevEng_PAJ7620.h</a></p>
<p>Place the <a class="el" href="classRevEng__PAJ7620.html" title="PAJ7620 Device API class - As developed by RevEng Devs.">RevEng_PAJ7620</a> library folder into your &lt;arduinoSketchFolder&gt;/libraries/ folder. You may need to create the libraries subfolder if its your first library. Restart the IDE.</p>
<p>There's a great tutorial on Arduino library installation at: <a href="http://learn.adafruit.com/adafruit-all-about-arduino-libraries-install-use">http://learn.adafruit.com/adafruit-all-about-arduino-libraries-install-use</a></p>
<p><b>Installing using arduino-cli</b></p>
<p>The arduino-cli (command line interface) tool keeps and maintains the same libraries as your ArduinoIDE environment. This library can be installed on the terminal with these commands:</p>
<blockquote class="doxtable">
<p>arduino-cli lib update-index <br  />
 arduino-cli lib install "RevEng PAJ7620" <br  />
 </p>
</blockquote>
<hr  />
<h1><a class="anchor" id="autotoc_md5"></a>
Example Sketches Provided</h1>
<p>This package comes with several example scripts to get you rolling quickly. In all cases, you need to connect the sensor to Vcc and Ground, plus the I2C lines: SDA &amp; SDL. For the interrupt driven sketch, you also need to connect the sensor's INT pin to pin 2 of your device. <br  />
 That should work for most arduino platforms (Uno, Mega). See the Arduino <a href="https://www.arduino.cc/reference/en/language/functions/external-interrupts/attachinterrupt/">attachInterrupt</a> documentation for the full list of boards and their interrupt capable pins.</p>
<p>Sketches provided:</p>
<ul>
<li>paj7620_up_down // Polls for only the up and down gestures and sets the builtin LED on and off</li>
<li>paj7620_9_gestures // Polls for all 9 gestures</li>
<li>paj7620_interrupt // Sets up an interrupt routine to wait for any gestures</li>
<li>paj7620_wave_count // Polls for the number of waves the sensor sees</li>
<li>paj7620_cursor_demo // Polls the sensor for a 'cursor', which is an object in front of the sensor. It then pulls the cursor location using (x,y) coordinates</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md7"></a>
Key code notes</h1>
<p>Major releases of this library have doxygen pages hosted on GitHub pages <a href="https://acrandal.github.io/RevEng_PAJ7620/">here</a>. The rest of this section gives a summary and notes of how the library's major features are designed.</p>
<p>To use this library, include the libary's header: </p><blockquote class="doxtable">
<p>#include "RevEng_PAJ7620.h" </p>
</blockquote>
<p>Create the driver object for the sensor: </p><blockquote class="doxtable">
<p><a class="el" href="classRevEng__PAJ7620.html" title="PAJ7620 Device API class - As developed by RevEng Devs.">RevEng_PAJ7620</a> sensor = <a class="el" href="classRevEng__PAJ7620.html" title="PAJ7620 Device API class - As developed by RevEng Devs.">RevEng_PAJ7620()</a>; </p>
</blockquote>
<p>In setup(), initialize and configure the driver: </p><blockquote class="doxtable">
<p>sensor.begin(); </p>
</blockquote>
<p>To read any gestures detected, use the readGesture() interface: </p><blockquote class="doxtable">
<p>Gesture gesture = sensor.readGesture(); </p>
</blockquote>
<p>The <a class="el" href="RevEng__PAJ7620_8h.html">RevEng_PAJ7620.h</a> header defines an enumerated type called Gesture for the gesture results. This enum provides a value for all 9 built in gestures and a "no gesture" result GES_NONE. The types it returns are: GES_NONE, GES_UP, GES_DOWN, GES_LEFT, GES_RIGHT, GES_FORWARD, GES_BACKWARD, GES_CLOCKWISE, GES_ANTICLOCKWISE, GES_WAVE</p>
<p>(GES stands for gesture)</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Sensor timing/sensitivity controls</h2>
<p>Reading a gesture has timing issues, notably the time it takes for the person to position their hand before starting a gesture and the time to remove their hand after finishing the gesture. These values are most important for the forward and backward gestures. To provide the ability to tune these timing values, two interfaces are provided to set their values in milliseconds: </p><blockquote class="doxtable">
<p>void setGestureEntryTime(unsigned long newGestureEntryTime); <br  />
 void setGestureExitTime(unsigned long newGestureExitTime); </p>
</blockquote>
<p>These values are defaulted to Entry Time: 0ms and Exit Time: 200ms. You might need to play with these values for your given application and expected use behaviors.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Wave Gesture Count</h2>
<p>The PAJ7620 sensor counts waves (rapid back and forth passes of an object) using a 4 bit register. Once the waving stops is when it raises the wave interrupt. The quantity of waves is available for reading and is exposed using this interface: </p><blockquote class="doxtable">
<p>int wave_count = sensor.getWaveCount(); </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md10"></a>
Enabling and Disabling sensor</h2>
<p>The PAJ7620 can be enabled and disabled during runtime. After the call to begin(), the device is already enabled and running. This library provides an interface to disable the devices and enable it as needed via these calls: </p><blockquote class="doxtable">
<p>sensor.disable(); <br  />
 sensor.enable(); </p>
</blockquote>
<p>When disabled, the sensor will not raise any interrupts, either on the interrupt pin or when calling readGesture(); <br  />
 NOTE: There is a more complete disabling that turns of all I2C messages, but that is not implemented fully here.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Multiple or Non-default Wire bus use</h2>
<p>To use other I2C busses than the default Wire, use the begin() initializer by passing a pointer to the bus you want. The library will store the bus of choice and use it from there on out. For example: </p><blockquote class="doxtable">
<p>sensor.begin(&amp;Wire1); </p>
</blockquote>
<p>You can use multiple PAJ7620 devices on an Arduino, with one per I2C bus if your device has multiple busses available. This would look like:</p>
<blockquote class="doxtable">
<p><a class="el" href="classRevEng__PAJ7620.html" title="PAJ7620 Device API class - As developed by RevEng Devs.">RevEng_PAJ7620</a> sensor = <a class="el" href="classRevEng__PAJ7620.html" title="PAJ7620 Device API class - As developed by RevEng Devs.">RevEng_PAJ7620()</a>; <br  />
 sensor.begin(&amp;Wire); <br  />
 <a class="el" href="classRevEng__PAJ7620.html" title="PAJ7620 Device API class - As developed by RevEng Devs.">RevEng_PAJ7620</a> sensor2 = <a class="el" href="classRevEng__PAJ7620.html" title="PAJ7620 Device API class - As developed by RevEng Devs.">RevEng_PAJ7620()</a>; <br  />
 sensor2.begin(&amp;Wire1); <br  />
 </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md12"></a>
Cursor Mode Summary</h2>
<p>The PAJ7620 sensor is capable of a 'cursor' mode. This is essentially a finger/object tracking capability where the center of the closest object in view is reported using (x,y) coordinates. This mode would be used for higher fidelity applications. The instantiation of the class is the same, and once it's initialized you can change to cursor mode and start tracking a target. </p><blockquote class="doxtable">
<p>sensor.setCursorMode(); <br  />
 sensor.isCursorInView(); <br  />
 sensor.getCursorX(); <br  />
 sensor.getCursorY(); <br  />
 </p>
</blockquote>
<p>The program can return to gesture mode with the setGestureMode call: </p><blockquote class="doxtable">
<p>sensor.setGestureMode(); </p>
</blockquote>
<hr  />
<h1><a class="anchor" id="autotoc_md14"></a>
Library History</h1>
<h3><a class="anchor" id="autotoc_md15"></a>
Version 1.4.0</h3>
<ul>
<li>Work done by <a href="https://github.com/acrandal">Aaron S. Crandall</a> &lt;<a href="#" onclick="location.href='mai'+'lto:'+'cra'+'nd'+'all'+'@g'+'onz'+'ag'+'a.e'+'du'; return false;">crand<span style="display: none;">.nosp@m.</span>all@<span style="display: none;">.nosp@m.</span>gonza<span style="display: none;">.nosp@m.</span>ga.e<span style="display: none;">.nosp@m.</span>du</a>&gt; and <a href="https://github.com/skallaher">Sean Kallaher</a>.</li>
<li>Developed cursor mode - an object tracking on a (x,y) coordinate system</li>
<li>Doxygen documentation system put in place</li>
<li>GitHub pages documentation updates on master merges and version tags</li>
<li>CI build and test framework, currently building on Linux, MacOS, and Windows</li>
<li>Added APIs for inverting the X and Y axes - works in all modes</li>
<li>Slimmed down the initialization array from 440 bytes to 100 bytes</li>
<li>Created a proper gesture mode register array to allow returning to gesture mode from cursor mode</li>
</ul>
<h3><a class="anchor" id="autotoc_md16"></a>
Version 1.3.0</h3>
<ul>
<li>Work done by <a href="https://github.com/acrandal">Aaron S. Crandall</a> &lt;<a href="#" onclick="location.href='mai'+'lto:'+'cra'+'nd'+'all'+'@g'+'onz'+'ag'+'a.e'+'du'; return false;">crand<span style="display: none;">.nosp@m.</span>all@<span style="display: none;">.nosp@m.</span>gonza<span style="display: none;">.nosp@m.</span>ga.e<span style="display: none;">.nosp@m.</span>du</a>&gt;.</li>
<li>Library now has a begin(TwoWire *bus) interface to allow user to pass a chosen TwoWire bus object for handling situations where they're using a second (or third) I2C bus on their device. For example: sensor.begin(&amp;Wire1).</li>
<li>Files re-arranged to comport with the <a href="https://arduino.github.io/arduino-cli/latest/library-specification/">Arduino IDE/CLI library specification</a> for 1.5.0+</li>
<li>Updated library.properties for the RevEng arduino library releases.</li>
<li>Added keywords.txt for ArduinoIDE syntax highlighting for driver.</li>
</ul>
<h3><a class="anchor" id="autotoc_md17"></a>
Version 1.2.0</h3>
<ul>
<li>Work done by <a href="https://github.com/acrandal">Aaron S. Crandall</a> &lt;<a href="#" onclick="location.href='mai'+'lto:'+'cra'+'nd'+'all'+'@g'+'onz'+'ag'+'a.e'+'du'; return false;">crand<span style="display: none;">.nosp@m.</span>all@<span style="display: none;">.nosp@m.</span>gonza<span style="display: none;">.nosp@m.</span>ga.e<span style="display: none;">.nosp@m.</span>du</a>&gt;. <br  />
</li>
<li>Library is able to return a current count of waves by the user. <br  />
</li>
<li>Library now provides several extra example Arduino programs to showcase using the wave feature and more of the API. <br  />
</li>
<li>Incorporated PROGMEM based approach to storing the extensive initialization configuration adapted from the <a href="https://www.jaycar.com.au/">Jaycar Electronics</a> fork, saving 21% of SRAM memory on an Arduino Uno (ATMega328P) board. <br  />
</li>
<li>Lots of object refactoring and method layout to make it easier to read and test.</li>
<li>Plenty of small formatting, commenting updates, and other details. <br  />
</li>
<li>Bugfix: Brought interrupt bits into alignment with official documentation for gesture directions (see v0.8 of PixArt device documentation).</li>
</ul>
<h3><a class="anchor" id="autotoc_md18"></a>
Version 1.1.0</h3>
<ul>
<li>Work done by <a href="https://github.com/MarcFinns">Marc Finns</a>. <br  />
</li>
<li>Based on the original SEEED library but with higher level API and fully encapsulated in a C++ object (no global variables). <br  />
</li>
<li>No need for registry manipulation in user code anymore. <br  />
</li>
<li>A gesture event is returned with an API call. <br  />
</li>
<li>Library provides an interrupt based example using the PAJ7620 object. <br  />
</li>
</ul>
<h3><a class="anchor" id="autotoc_md19"></a>
Version 1.0.0</h3>
<ul>
<li><a href="https://www.seeedstudio.com/">SEEED</a> released <a href="https://github.com/Seeed-Studio/Gesture_PAJ7620">library</a> is able to identify and return all 9 gestures and up to 15 calculated gestures in example Arduino code.</li>
</ul>
<p><b>Contributors</b></p><ul>
<li>Original Code from SEEED - Jack Wu, Wuruibin, &amp; Xiangnan, June 2015</li>
<li>Initial class-based solution - Marc Finns, 2017</li>
<li>PROGMEM adapted from Jaycar Elctronics' fork, December 2020</li>
<li>Overhaul, documentation, and current version by Aaron S. Crandall, December 2020</li>
<li>Pull requests, CI framework, and doxygen materials by Sean Kallaher (skallaher), December 2020</li>
</ul>
<p><b>License</b> <br  />
 MIT - see LICENSE file</p>
<p><b>Version</b> <br  />
 1.4.0 </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
